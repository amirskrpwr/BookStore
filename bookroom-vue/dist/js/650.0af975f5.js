"use strict";(self["webpackChunkbookroom_vue"]=self["webpackChunkbookroom_vue"]||[]).push([[650],{5650:function(t,s,e){e.r(s),e.d(s,{default:function(){return st}});var o=e(3396),a=e(9242),l=e(7139);const r=t=>((0,o.dD)("data-v-6a65fe27"),t=t(),(0,o.Cn)(),t),i={class:"row"},n={class:"col-lg-6"},d={class:"box-element",id:"form-wrapper"},c={id:"shipping-info"},u=r((()=>(0,o._)("h3",null,"اطلاعات ارسال:",-1))),m=r((()=>(0,o._)("hr",null,null,-1))),f={class:"form-field"},b={class:"form-field"},h={class:"form-field"},g=r((()=>(0,o._)("hr",null,null,-1))),y=r((()=>(0,o._)("button",{type:"submit",class:"btn btn-success",id:"form-button"}," ادامه ",-1))),v=r((()=>(0,o._)("br",null,null,-1))),p=r((()=>(0,o._)("div",{class:"box-element d-flex justify-content-center hidden",id:"complete"},[(0,o._)("button",{class:"btn btn-success","data-bs-toggle":"modal","data-bs-target":"#demo"}," تکمیل خرید ")],-1))),_={class:"col-lg-6"},w={class:"box-element"},x={class:"p-2"},k=(0,o.Uk)(" بازگشت به سبد خرید "),T=(0,o.uE)('<hr data-v-6a65fe27><h3 data-v-6a65fe27>خلاصه سفارش</h3><hr data-v-6a65fe27><div class="cart-row" data-v-6a65fe27><div style="flex:2;" data-v-6a65fe27></div><div style="flex:2;" class="ms-4" data-v-6a65fe27><strong data-v-6a65fe27>عنوان</strong></div><div style="flex:1.75;" class="ms-2" data-v-6a65fe27><strong data-v-6a65fe27>قیمت</strong></div><div style="flex:0.5;" class="ms-2" data-v-6a65fe27><strong data-v-6a65fe27>تعداد</strong></div></div>',4),F={style:{flex:"2"},class:"align-self-center"},C=["src","alt"],B={style:{flex:"2"},class:"align-self-center ms-4"},D={style:{flex:"1.75"},class:"align-self-center ms-2"},N={style:{flex:"0.5"},class:"align-self-center ms-2"},z={class:"row"},W=r((()=>(0,o._)("h6",{style:{flex:"1"}},[(0,o._)("strong",null,"تعداد کتاب ها: ")],-1))),q={style:{flex:"2"}},I={key:0,class:"row"},L=r((()=>(0,o._)("h6",{style:{flex:"1"}},[(0,o._)("strong",null,"مجموع: ")],-1))),O={style:{flex:"2"}},$={key:1,class:"row"},A=r((()=>(0,o._)("h6",{style:{flex:"1"}},[(0,o._)("strong",null,"مجموع تخفیف: ")],-1))),U={style:{flex:"2"},class:"text-success"},M={class:"row"},S=r((()=>(0,o._)("h6",{style:{flex:"1"}},[(0,o._)("strong",null,"مجموع قابل پرداخت: ")],-1))),V={style:{flex:"2"}},E={class:"modal fade",id:"demo",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},j={class:"modal-dialog"},H={class:"modal-content"},K=r((()=>(0,o._)("div",{class:"modal-header"},[(0,o._)("h5",{class:"modal-title",id:"exampleModalLabel"},"نهایی کردن خرید"),(0,o._)("div",{class:"d-flex flex-row-reverse"},[(0,o._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})])],-1))),R={class:"modal-body"},Y={class:"modal-footer"},Z=r((()=>(0,o._)("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," خیر ",-1)));function G(t,s,e,r,G,J){const P=(0,o.up)("router-link");return(0,o.wg)(),(0,o.iD)("div",i,[(0,o._)("div",n,[(0,o._)("div",d,[(0,o._)("form",{onSubmit:s[3]||(s[3]=(0,a.iM)(((...t)=>J.showButton&&J.showButton(...t)),["prevent"])),class:"p-2",action:"",id:"form"},[(0,o._)("div",c,[u,m,(0,o._)("div",f,[(0,o.wy)((0,o._)("input",{type:"text",placeholder:"استان..",name:"state",id:"state","onUpdate:modelValue":s[0]||(s[0]=t=>G.state=t),class:"form-control"},null,512),[[a.nr,G.state]])]),(0,o._)("div",b,[(0,o.wy)((0,o._)("input",{type:"text",placeholder:"شهر..",name:"city",id:"city","onUpdate:modelValue":s[1]||(s[1]=t=>G.city=t),class:"form-control"},null,512),[[a.nr,G.city]])]),(0,o._)("div",h,[(0,o.wy)((0,o._)("input",{type:"text",placeholder:"نشانی..",name:"address",id:"address","onUpdate:modelValue":s[2]||(s[2]=t=>G.address=t),class:"form-control"},null,512),[[a.nr,G.address]])])]),g,y],32)]),v,p]),(0,o._)("div",_,[(0,o._)("div",w,[(0,o._)("div",x,[(0,o.Wm)(P,{to:"/cart",class:"btn btn-outline-dark"},{default:(0,o.w5)((()=>[k])),_:1}),T,((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(G.cart.items,(t=>((0,o.wg)(),(0,o.iD)("div",{key:t.id,class:"cart-row"},[(0,o._)("div",F,[(0,o.Wm)(P,{to:t.book.get_absolute_url},{default:(0,o.w5)((()=>[(0,o._)("img",{src:t.book.get_image,alt:J.toFarsiNumber(t.book.name),class:"row-image short"},null,8,C)])),_:2},1032,["to"])]),(0,o._)("div",B,[(0,o._)("p",null,(0,l.zw)(J.toFarsiNumber(t.book.name)),1)]),(0,o._)("div",D,[(0,o._)("p",null,(0,l.zw)(J.toFarsiNumber(J.numberByCommas(parseInt(t.book.price))))+" تومان ",1)]),(0,o._)("div",N,[(0,o._)("p",null,(0,l.zw)(J.toFarsiNumber(t.quantity)),1)])])))),128)),(0,o._)("div",z,[W,(0,o._)("h6",q,(0,l.zw)(J.toFarsiNumber(J.getTotalCount))+" کتاب",1)]),J.getTotalDiscount?((0,o.wg)(),(0,o.iD)("div",I,[L,(0,o._)("h6",O,(0,l.zw)(J.toFarsiNumber(J.numberByCommas(J.getTotalAmount)))+" تومان ",1)])):(0,o.kq)("",!0),J.getTotalDiscount?((0,o.wg)(),(0,o.iD)("div",$,[A,(0,o._)("h6",U,(0,l.zw)(J.toFarsiNumber(J.numberByCommas(J.getTotalDiscount)))+" تومان ",1)])):(0,o.kq)("",!0),(0,o._)("div",M,[S,(0,o._)("h6",V,(0,l.zw)(J.toFarsiNumber(J.numberByCommas(J.getTotalAmount-J.getTotalDiscount)))+" تومان ",1)])])])]),(0,o._)("div",E,[(0,o._)("div",j,[(0,o._)("div",H,[K,(0,o._)("div",R," آیا می‌خواهید این "+(0,l.zw)(J.toFarsiNumber(J.getTotalCount))+" کتاب را با مجموع "+(0,l.zw)(J.toFarsiNumber(J.numberByCommas(J.getTotalAmount)))+" تومان خریداری کنید؟ ",1),(0,o._)("div",Y,[Z,(0,o._)("button",{type:"button",onClick:s[4]||(s[4]=(...t)=>J.submitForm&&J.submitForm(...t)),class:"btn btn-primary","data-bs-dismiss":"modal"}," بله ")])])])])])}var J=e(6265),P=e.n(J),Q={name:"checkout",data(){return{cart:{items:[]},state:"",city:"",address:"",errors:[]}},mounted(){document.title="Checkout | BookRoom",this.cart=this.$store.state.cart},computed:{getTotalAmount(){let t=0;for(let s of this.cart.items)t+=s.quantity*s.book.price;return t},getTotalCount(){let t=0;for(let s of this.cart.items)t+=s.quantity;return t},getTotalDiscount(){let t=0;for(let s of this.cart.items)t+=s.quantity*s.book.discount/100*s.book.price;return t}},methods:{numberByCommas(t){return t.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")},showButton(){this.errors=[],""===this.state&&(this.errors.push("فیلد استان وارد نشده‌ است."),Toastify({text:"فیلد استان وارد نشده‌ است.",duration:3e3,newWindow:!0,gravity:"bottom",position:"right",stopOnFocus:!0,style:{background:"#ff652f"}}).showToast()),""===this.city&&(this.errors.push("فیلد شهر وارد نشده‌ است."),Toastify({text:"فیلد شهر وارد نشده‌ است.",duration:3e3,newWindow:!0,gravity:"bottom",position:"right",stopOnFocus:!0,style:{background:"#ff652f"}}).showToast()),""===this.address&&(this.errors.push("فیلد آدرس وارد نشده‌ است."),Toastify({text:"فیلد آدرس وارد نشده است.",duration:3e3,newWindow:!0,gravity:"bottom",position:"right",stopOnFocus:!0,style:{background:"#ff652f"}}).showToast()),this.errors.length||document.getElementById("complete").classList.remove("hidden")},async submitForm(){const t={complete:!0,orderItems:this.cart.items,state:this.state,city:this.city,address:this.address};this.errors.length||(this.$store.commit("setIsLoading",!0),await P().post("api/v1/checkout/",t).then((t=>{this.$store.commit("clearCart"),Toastify({text:"خرید شما با موفقیت صورت گرفت.",duration:3e3,newWindow:!0,gravity:"bottom",position:"right",stopOnFocus:!0,style:{background:"#5cdb95"}}).showToast(),this.$router.push("/cart/success")})).catch((t=>{this.errors.push("something went wrong. please try again."),console.log(t),Toastify({text:"مشکلی در عملیات خرید پیش آمد لطفا دوباره امتحان کنید.",duration:3e3,newWindow:!0,gravity:"bottom",position:"right",stopOnFocus:!0,style:{background:"#ff652f"}}).showToast()})),this.$store.commit("setIsLoading",!1))},toFarsiNumber(t){const s=["۰","۱","۲","۳","۴","۵","۶","۷","۸","۹"];return t.toString().replace(/\d/g,(t=>s[t]))}}},X=e(89);const tt=(0,X.Z)(Q,[["render",G],["__scopeId","data-v-6a65fe27"]]);var st=tt}}]);
//# sourceMappingURL=650.0af975f5.js.map